<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Subscribe - conversions.lol</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  <link rel="icon" href="{{ url_for('static', filename='favicon.png') }}" type="image/x-icon" />
</head>
<body>
  <a href="{{ url_for('account') }}" class="auth-icon" title="Back to Account">Account</a>

  <div class="container">
    <h1>Premium Subscription</h1>
    <h2>Unlock professional AI-powered features</h2>

    <section style="max-width: 600px; margin: 0 auto;">
      <h3>What's Included</h3>
      <ul style="margin-bottom: 40px;">
        <li>✓ Unlimited AI-powered translations</li>
        <li>✓ Professional OCR text extraction</li>
        <li>✓ Support for 4 languages (Spanish, French, Arabic, Chinese)</li>
        <li>✓ Advanced PDF processing</li>
        <li>✓ Priority support</li>
        <li>✓ No file size limits</li>
      </ul>

      <div style="background: #1a1a1a; padding: 40px; border-radius: 20px; text-align: center; border: 1px solid #333333;">
        <h3 style="color: #B85450; margin-bottom: 20px;">Monthly Subscription</h3>
        <div style="font-size: 48px; font-weight: 300; color: #ffffff; margin-bottom: 10px;">$9.99</div>
        <div style="color: #999999; margin-bottom: 30px;">per month</div>
        
        <button id="subscribe-btn" type="button" style="background: #B85450; color: white; font-size: 18px; font-weight: 500; border: none; padding: 20px 40px; border-radius: 16px; cursor: pointer; transition: all 0.3s ease; width: 100%; margin-bottom: 20px;">
          Subscribe Now
        </button>
        
        <div id="loader" style="display: none; color: #999999; margin-top: 20px;">
          Processing your request...
        </div>
        
        <div id="error-message" style="color: #B85450; margin-top: 20px; font-weight: 500;"></div>
      </div>

      <div style="margin-top: 40px; padding: 30px; background: #1a1a1a; border-radius: 16px; border: 1px solid #333333;">
        <h4 style="color: #ffffff; margin-bottom: 20px;">Security & Privacy</h4>
        <ul style="color: #cccccc; font-size: 16px;">
          <li>Secure payment processing via Stripe</li>
          <li>PCI DSS compliant infrastructure</li>
          <li>Cancel anytime, no long-term commitment</li>
          <li>Your files are never stored permanently</li>
        </ul>
      </div>

      <div style="margin-top: 30px; padding: 30px; background: #1a1a1a; border-radius: 16px; border: 1px solid #333333;">
        <h4 style="color: #ffffff; margin-bottom: 20px;">Translation Quality</h4>
        <ul style="color: #cccccc; font-size: 16px;">
          <li><strong>Spanish & French:</strong> High accuracy, preserves formatting</li>
          <li><strong>Arabic & Chinese:</strong> Professional quality, TXT output</li>
          <li><strong>OCR:</strong> Works with PDF, JPG, PNG - quality depends on source</li>
        </ul>
      </div>
    </section>
  </div>

  <script>
    const subscribeBtn = document.getElementById('subscribe-btn');
    const loader = document.getElementById('loader');
    const errorMessage = document.getElementById('error-message');

    function showLoader(show) {
      loader.style.display = show ? 'block' : 'none';
      subscribeBtn.disabled = show;
      subscribeBtn.style.opacity = show ? '0.6' : '1';
    }

    function showError(msg) {
      errorMessage.textContent = msg || '';
    }

    subscribeBtn.addEventListener('click', async () => {
      showLoader(true);
      showError('');

      try {
        const response = await fetch('/create-checkout-session', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          }
        });

        const data = await response.json();
        
        if (!response.ok) {
          throw new Error(data.error || 'Failed to create checkout session');
        }

        // Redirect to Stripe Checkout
        window.location.href = data.checkout_url;
      } catch (err) {
        console.error(err);
        showError(err.message || 'Unable to start checkout process.');
        showLoader(false);
      }
    });
  </script>
</body>
</html>